import{l as wt,S as dr,a as Y,b as pr,c as Lt,d as Tt,e as Nt,g as pt,D as Ot,f as Er,h as yt}from"./index-DRLFMGSj.js";let Et=0;const M=[],mr=(i,n,e)=>{const t={type:i,id:String(++Et),date:new Date};n&&(t.message=n),mt(t)},At=({type:i,message:n,data:e,context:t})=>{const s={type:i,id:String(++Et),date:new Date};n&&(s.message=n),e&&(s.data=e),t&&(s.context=t),mt(s)};class W{constructor(n,e){this.type=n,this.context=e}trace(n,e){At({type:this.type,message:n,data:e,context:this.context})}getContext(){return this.context}setContext(n){this.context=n}updateContext(n){this.context=Object.assign(Object.assign({},this.context),n)}getType(){return this.type}setType(n){this.type=n}withType(n){return new W(n,this.context)}withContext(n){return new W(this.type,n)}withUpdatedContext(n){return new W(this.type,Object.assign(Object.assign({},this.context),n))}}const Pt=i=>(M.push(i),()=>{const n=M.indexOf(i);n!==-1&&(M[n]=M[M.length-1],M.pop())});function mt(i){for(let n=0;n<M.length;n++)try{M[n](i)}catch(e){console.error(e)}}typeof window<"u"&&(window.__ledgerLogsListen=Pt);var Z=function(i,n,e,t){function s(o){return o instanceof e?o:new e(function(c){c(o)})}return new(e||(e=Promise))(function(o,c){function h(r){try{l(t.next(r))}catch(u){c(u)}}function a(r){try{l(t.throw(r))}catch(u){c(u)}}function l(r){r.done?o(r.value):s(r.value).then(h,a)}l((t=t.apply(i,n||[])).next())})};const Ct="transport";class ar{constructor({context:n,logType:e}={}){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new wt,this.send=(t,s,o,c,...h)=>Z(this,[t,s,o,c,...h],void 0,function*(a,l,r,u,f=Buffer.alloc(0),d=[dr.OK],{abortTimeoutMs:v}={}){const p=this.tracer.withUpdatedContext({function:"send"});if(f.length>=256)throw p.trace("data.length exceeded 256 bytes limit",{dataLength:f.length}),new Y("data.length exceed 256 bytes limit. Got: "+f.length,"DataLengthTooBig");p.trace("Starting an exchange",{abortTimeoutMs:v});const S=yield this.exchange(Buffer.concat([Buffer.from([a,l,r,u]),Buffer.from([f.length]),f]),{abortTimeoutMs:v});p.trace("Received response from exchange");const T=S.readUInt16BE(S.length-2);if(!d.some(C=>C===T))throw new pr(T);return S}),this._appAPIlock=null,this.tracer=new W(e??Ct,n)}exchange(n,{abortTimeoutMs:e}={}){throw new Error("exchange not implemented")}exchangeBulk(n,e){let t=!1;const s=()=>{t=!0};return Z(this,void 0,void 0,function*(){if(!t)for(const c of n){const h=yield this.exchange(c);if(t)return;const a=h.readUInt16BE(h.length-2);if(a!==dr.OK)throw new pr(a);e.next(h)}}).then(()=>!t&&e.complete(),c=>!t&&e.error(c)),{unsubscribe:s}}setScrambleKey(n){}close(){return Promise.resolve()}on(n,e){this._events.on(n,e)}off(n,e){this._events.removeListener(n,e)}emit(n,...e){this._events.emit(n,...e)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(n){this.exchangeTimeout=n}setExchangeUnresponsiveTimeout(n){this.unresponsiveTimeout=n}static create(n=3e3,e){return new Promise((t,s)=>{let o=!1;const c=this.listen({next:a=>{o=!0,c&&c.unsubscribe(),h&&clearTimeout(h),this.open(a.descriptor,n).then(t,s)},error:a=>{h&&clearTimeout(h),s(a)},complete:()=>{h&&clearTimeout(h),o||s(new Y(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),h=e?setTimeout(()=>{c.unsubscribe(),s(new Y(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},e):null})}exchangeAtomicImpl(n){return Z(this,void 0,void 0,function*(){const e=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw e.trace("Atomic exchange is already busy"),new Lt("An action was already pending on the Ledger device. Please deny or reconnect.");let t;const s=new Promise(h=>{t=h});this.exchangeBusyPromise=s;let o=!1;const c=setTimeout(()=>{e.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),o=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const h=yield n();return o&&(e.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),h}finally{e.trace("Finalize, clearing busy guard"),clearTimeout(c),t&&t(),this.exchangeBusyPromise=null}})}decorateAppAPIMethods(n,e,t){for(const s of e)n[s]=this.decorateAppAPIMethod(s,n[s],n,t)}decorateAppAPIMethod(n,e,t,s){return(...o)=>Z(this,void 0,void 0,function*(){const{_appAPIlock:c}=this;if(c)return Promise.reject(new Y("Ledger Device is busy (lock "+c+")","TransportLocked"));try{return this._appAPIlock=n,this.setScrambleKey(s),yield e.apply(t,o)}finally{this._appAPIlock=null}})}setTraceContext(n){this.tracer=this.tracer.withContext(n)}updateTraceContext(n){this.tracer.updateContext(n)}getTraceContext(){return this.tracer.getContext()}}ar.ErrorMessage_ListenTimeout="No Ledger device found (timeout)";ar.ErrorMessage_NoDeviceFound="No Ledger device found";var le={};const xt=Tt(Nt);var vr;function qt(){return vr||(vr=1,function(i){i.__esModule=!0;var n=xt,e=5;function t(c){var h=Buffer.alloc(2);return h.writeUInt16BE(c,0),h}var s={data:Buffer.alloc(0),dataLength:0,sequence:0},o=function(c,h){return{makeBlocks:function(a){var l=Buffer.concat([t(a.length),a]),r=h-5,u=Math.ceil(l.length/r);l=Buffer.concat([l,Buffer.alloc(u*r-l.length+1).fill(0)]);for(var f=[],d=0;d<u;d++){var v=Buffer.alloc(5);v.writeUInt16BE(c,0),v.writeUInt8(e,2),v.writeUInt16BE(d,3);var p=l.slice(d*r,(d+1)*r);f.push(Buffer.concat([v,p]))}return f},reduceResponse:function(a,l){var r=a||s,u=r.data,f=r.dataLength,d=r.sequence;if(l.readUInt16BE(0)!==c)throw new n.TransportError("Invalid channel","InvalidChannel");if(l.readUInt8(2)!==e)throw new n.TransportError("Invalid tag","InvalidTag");if(l.readUInt16BE(3)!==d)throw new n.TransportError("Invalid sequence","InvalidSequence");a||(f=l.readUInt16BE(5)),d++;var v=l.slice(a?5:7);return u=Buffer.concat([u,v]),u.length>f&&(u=u.slice(0,f)),{data:u,dataLength:f,sequence:d}},getReducedResult:function(a){if(a&&a.dataLength===a.data.length)return a.data}}};i.default=o}(le)),le}var _t=qt();const bt=pt(_t);var J={exports:{}},fe,Rr;function re(){if(Rr)return fe;Rr=1;const i="2.0.0",n=256,e=Number.MAX_SAFE_INTEGER||9007199254740991,t=16,s=n-6;return fe={MAX_LENGTH:n,MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:s,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:i,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},fe}var he,gr;function te(){if(gr)return he;gr=1;var i={};return he=typeof process=="object"&&i&&i.NODE_DEBUG&&/\bsemver\b/i.test(i.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{},he}var Ir;function K(){return Ir||(Ir=1,function(i,n){const{MAX_SAFE_COMPONENT_LENGTH:e,MAX_SAFE_BUILD_LENGTH:t,MAX_LENGTH:s}=re(),o=te();n=i.exports={};const c=n.re=[],h=n.safeRe=[],a=n.src=[],l=n.safeSrc=[],r=n.t={};let u=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",s],[f,t]],v=S=>{for(const[T,C]of d)S=S.split(`${T}*`).join(`${T}{0,${C}}`).split(`${T}+`).join(`${T}{1,${C}}`);return S},p=(S,T,C)=>{const y=v(T),b=u++;o(S,b,T),r[S]=b,a[b]=T,l[b]=y,c[b]=new RegExp(T,C?"g":void 0),h[b]=new RegExp(y,C?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${a[r.NUMERICIDENTIFIER]})\\.(${a[r.NUMERICIDENTIFIER]})\\.(${a[r.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${a[r.NUMERICIDENTIFIERLOOSE]})\\.(${a[r.NUMERICIDENTIFIERLOOSE]})\\.(${a[r.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${a[r.NUMERICIDENTIFIER]}|${a[r.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${a[r.NUMERICIDENTIFIERLOOSE]}|${a[r.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${a[r.PRERELEASEIDENTIFIER]}(?:\\.${a[r.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${a[r.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[r.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${a[r.BUILDIDENTIFIER]}(?:\\.${a[r.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${a[r.MAINVERSION]}${a[r.PRERELEASE]}?${a[r.BUILD]}?`),p("FULL",`^${a[r.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${a[r.MAINVERSIONLOOSE]}${a[r.PRERELEASELOOSE]}?${a[r.BUILD]}?`),p("LOOSE",`^${a[r.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${a[r.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${a[r.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${a[r.XRANGEIDENTIFIER]})(?:\\.(${a[r.XRANGEIDENTIFIER]})(?:\\.(${a[r.XRANGEIDENTIFIER]})(?:${a[r.PRERELEASE]})?${a[r.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${a[r.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[r.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[r.XRANGEIDENTIFIERLOOSE]})(?:${a[r.PRERELEASELOOSE]})?${a[r.BUILD]}?)?)?`),p("XRANGE",`^${a[r.GTLT]}\\s*${a[r.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${a[r.GTLT]}\\s*${a[r.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?`),p("COERCE",`${a[r.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",a[r.COERCEPLAIN]+`(?:${a[r.PRERELEASE]})?(?:${a[r.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",a[r.COERCE],!0),p("COERCERTLFULL",a[r.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${a[r.LONETILDE]}\\s+`,!0),n.tildeTrimReplace="$1~",p("TILDE",`^${a[r.LONETILDE]}${a[r.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${a[r.LONETILDE]}${a[r.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${a[r.LONECARET]}\\s+`,!0),n.caretTrimReplace="$1^",p("CARET",`^${a[r.LONECARET]}${a[r.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${a[r.LONECARET]}${a[r.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${a[r.GTLT]}\\s*(${a[r.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${a[r.GTLT]}\\s*(${a[r.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${a[r.GTLT]}\\s*(${a[r.LOOSEPLAIN]}|${a[r.XRANGEPLAIN]})`,!0),n.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${a[r.XRANGEPLAIN]})\\s+-\\s+(${a[r.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${a[r.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[r.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(J,J.exports)),J.exports}var de,$r;function or(){if($r)return de;$r=1;const i=Object.freeze({loose:!0}),n=Object.freeze({});return de=t=>t?typeof t!="object"?i:t:n,de}var pe,Sr;function vt(){if(Sr)return pe;Sr=1;const i=/^[0-9]+$/,n=(t,s)=>{const o=i.test(t),c=i.test(s);return o&&c&&(t=+t,s=+s),t===s?0:o&&!c?-1:c&&!o?1:t<s?-1:1};return pe={compareIdentifiers:n,rcompareIdentifiers:(t,s)=>n(s,t)},pe}var Ee,wr;function U(){if(wr)return Ee;wr=1;const i=te(),{MAX_LENGTH:n,MAX_SAFE_INTEGER:e}=re(),{safeRe:t,safeSrc:s,t:o}=K(),c=or(),{compareIdentifiers:h}=vt();class a{constructor(r,u){if(u=c(u),r instanceof a){if(r.loose===!!u.loose&&r.includePrerelease===!!u.includePrerelease)return r;r=r.version}else if(typeof r!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof r}".`);if(r.length>n)throw new TypeError(`version is longer than ${n} characters`);i("SemVer",r,u),this.options=u,this.loose=!!u.loose,this.includePrerelease=!!u.includePrerelease;const f=r.trim().match(u.loose?t[o.LOOSE]:t[o.FULL]);if(!f)throw new TypeError(`Invalid Version: ${r}`);if(this.raw=r,this.major=+f[1],this.minor=+f[2],this.patch=+f[3],this.major>e||this.major<0)throw new TypeError("Invalid major version");if(this.minor>e||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>e||this.patch<0)throw new TypeError("Invalid patch version");f[4]?this.prerelease=f[4].split(".").map(d=>{if(/^[0-9]+$/.test(d)){const v=+d;if(v>=0&&v<e)return v}return d}):this.prerelease=[],this.build=f[5]?f[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(r){if(i("SemVer.compare",this.version,this.options,r),!(r instanceof a)){if(typeof r=="string"&&r===this.version)return 0;r=new a(r,this.options)}return r.version===this.version?0:this.compareMain(r)||this.comparePre(r)}compareMain(r){return r instanceof a||(r=new a(r,this.options)),h(this.major,r.major)||h(this.minor,r.minor)||h(this.patch,r.patch)}comparePre(r){if(r instanceof a||(r=new a(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;let u=0;do{const f=this.prerelease[u],d=r.prerelease[u];if(i("prerelease compare",u,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return h(f,d)}while(++u)}compareBuild(r){r instanceof a||(r=new a(r,this.options));let u=0;do{const f=this.build[u],d=r.build[u];if(i("build compare",u,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return h(f,d)}while(++u)}inc(r,u,f){if(r.startsWith("pre")){if(!u&&f===!1)throw new Error("invalid increment argument: identifier is empty");if(u){const d=new RegExp(`^${this.options.loose?s[o.PRERELEASELOOSE]:s[o.PRERELEASE]}$`),v=`-${u}`.match(d);if(!v||v[1]!==u)throw new Error(`invalid identifier: ${u}`)}}switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",u,f);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",u,f);break;case"prepatch":this.prerelease.length=0,this.inc("patch",u,f),this.inc("pre",u,f);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",u,f),this.inc("pre",u,f);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const d=Number(f)?1:0;if(this.prerelease.length===0)this.prerelease=[d];else{let v=this.prerelease.length;for(;--v>=0;)typeof this.prerelease[v]=="number"&&(this.prerelease[v]++,v=-2);if(v===-1){if(u===this.prerelease.join(".")&&f===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(d)}}if(u){let v=[u,d];f===!1&&(v=[u]),h(this.prerelease[0],u)===0?isNaN(this.prerelease[1])&&(this.prerelease=v):this.prerelease=v}break}default:throw new Error(`invalid increment argument: ${r}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Ee=a,Ee}var me,Lr;function V(){if(Lr)return me;Lr=1;const i=U();return me=(e,t,s=!1)=>{if(e instanceof i)return e;try{return new i(e,t)}catch(o){if(!s)return null;throw o}},me}var ve,Tr;function Dt(){if(Tr)return ve;Tr=1;const i=V();return ve=(e,t)=>{const s=i(e,t);return s?s.version:null},ve}var Re,Nr;function Ut(){if(Nr)return Re;Nr=1;const i=V();return Re=(e,t)=>{const s=i(e.trim().replace(/^[=v]+/,""),t);return s?s.version:null},Re}var ge,Or;function Ft(){if(Or)return ge;Or=1;const i=U();return ge=(e,t,s,o,c)=>{typeof s=="string"&&(c=o,o=s,s=void 0);try{return new i(e instanceof i?e.version:e,s).inc(t,o,c).version}catch{return null}},ge}var Ie,yr;function Gt(){if(yr)return Ie;yr=1;const i=V();return Ie=(e,t)=>{const s=i(e,null,!0),o=i(t,null,!0),c=s.compare(o);if(c===0)return null;const h=c>0,a=h?s:o,l=h?o:s,r=!!a.prerelease.length;if(!!l.prerelease.length&&!r){if(!l.patch&&!l.minor)return"major";if(l.compareMain(a)===0)return l.minor&&!l.patch?"minor":"patch"}const f=r?"pre":"";return s.major!==o.major?f+"major":s.minor!==o.minor?f+"minor":s.patch!==o.patch?f+"patch":"prerelease"},Ie}var $e,Ar;function jt(){if(Ar)return $e;Ar=1;const i=U();return $e=(e,t)=>new i(e,t).major,$e}var Se,Pr;function Bt(){if(Pr)return Se;Pr=1;const i=U();return Se=(e,t)=>new i(e,t).minor,Se}var we,Cr;function kt(){if(Cr)return we;Cr=1;const i=U();return we=(e,t)=>new i(e,t).patch,we}var Le,xr;function Mt(){if(xr)return Le;xr=1;const i=V();return Le=(e,t)=>{const s=i(e,t);return s&&s.prerelease.length?s.prerelease:null},Le}var Te,qr;function G(){if(qr)return Te;qr=1;const i=U();return Te=(e,t,s)=>new i(e,s).compare(new i(t,s)),Te}var Ne,_r;function Xt(){if(_r)return Ne;_r=1;const i=G();return Ne=(e,t,s)=>i(t,e,s),Ne}var Oe,br;function Vt(){if(br)return Oe;br=1;const i=G();return Oe=(e,t)=>i(e,t,!0),Oe}var ye,Dr;function cr(){if(Dr)return ye;Dr=1;const i=U();return ye=(e,t,s)=>{const o=new i(e,s),c=new i(t,s);return o.compare(c)||o.compareBuild(c)},ye}var Ae,Ur;function Ht(){if(Ur)return Ae;Ur=1;const i=cr();return Ae=(e,t)=>e.sort((s,o)=>i(s,o,t)),Ae}var Pe,Fr;function zt(){if(Fr)return Pe;Fr=1;const i=cr();return Pe=(e,t)=>e.sort((s,o)=>i(o,s,t)),Pe}var Ce,Gr;function ne(){if(Gr)return Ce;Gr=1;const i=G();return Ce=(e,t,s)=>i(e,t,s)>0,Ce}var xe,jr;function ur(){if(jr)return xe;jr=1;const i=G();return xe=(e,t,s)=>i(e,t,s)<0,xe}var qe,Br;function Rt(){if(Br)return qe;Br=1;const i=G();return qe=(e,t,s)=>i(e,t,s)===0,qe}var _e,kr;function gt(){if(kr)return _e;kr=1;const i=G();return _e=(e,t,s)=>i(e,t,s)!==0,_e}var be,Mr;function lr(){if(Mr)return be;Mr=1;const i=G();return be=(e,t,s)=>i(e,t,s)>=0,be}var De,Xr;function fr(){if(Xr)return De;Xr=1;const i=G();return De=(e,t,s)=>i(e,t,s)<=0,De}var Ue,Vr;function It(){if(Vr)return Ue;Vr=1;const i=Rt(),n=gt(),e=ne(),t=lr(),s=ur(),o=fr();return Ue=(h,a,l,r)=>{switch(a){case"===":return typeof h=="object"&&(h=h.version),typeof l=="object"&&(l=l.version),h===l;case"!==":return typeof h=="object"&&(h=h.version),typeof l=="object"&&(l=l.version),h!==l;case"":case"=":case"==":return i(h,l,r);case"!=":return n(h,l,r);case">":return e(h,l,r);case">=":return t(h,l,r);case"<":return s(h,l,r);case"<=":return o(h,l,r);default:throw new TypeError(`Invalid operator: ${a}`)}},Ue}var Fe,Hr;function Yt(){if(Hr)return Fe;Hr=1;const i=U(),n=V(),{safeRe:e,t}=K();return Fe=(o,c)=>{if(o instanceof i)return o;if(typeof o=="number"&&(o=String(o)),typeof o!="string")return null;c=c||{};let h=null;if(!c.rtl)h=o.match(c.includePrerelease?e[t.COERCEFULL]:e[t.COERCE]);else{const d=c.includePrerelease?e[t.COERCERTLFULL]:e[t.COERCERTL];let v;for(;(v=d.exec(o))&&(!h||h.index+h[0].length!==o.length);)(!h||v.index+v[0].length!==h.index+h[0].length)&&(h=v),d.lastIndex=v.index+v[1].length+v[2].length;d.lastIndex=-1}if(h===null)return null;const a=h[2],l=h[3]||"0",r=h[4]||"0",u=c.includePrerelease&&h[5]?`-${h[5]}`:"",f=c.includePrerelease&&h[6]?`+${h[6]}`:"";return n(`${a}.${l}.${r}${u}${f}`,c)},Fe}var Ge,zr;function Wt(){if(zr)return Ge;zr=1;class i{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(e,t)}return this}}return Ge=i,Ge}var je,Yr;function j(){if(Yr)return je;Yr=1;const i=/\s+/g;class n{constructor(E,I){if(I=s(I),E instanceof n)return E.loose===!!I.loose&&E.includePrerelease===!!I.includePrerelease?E:new n(E.raw,I);if(E instanceof o)return this.raw=E.value,this.set=[[E]],this.formatted=void 0,this;if(this.options=I,this.loose=!!I.loose,this.includePrerelease=!!I.includePrerelease,this.raw=E.trim().replace(i," "),this.set=this.raw.split("||").map(R=>this.parseRange(R.trim())).filter(R=>R.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const R=this.set[0];if(this.set=this.set.filter($=>!p($[0])),this.set.length===0)this.set=[R];else if(this.set.length>1){for(const $ of this.set)if($.length===1&&S($[0])){this.set=[$];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let E=0;E<this.set.length;E++){E>0&&(this.formatted+="||");const I=this.set[E];for(let R=0;R<I.length;R++)R>0&&(this.formatted+=" "),this.formatted+=I[R].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(E){const R=((this.options.includePrerelease&&d)|(this.options.loose&&v))+":"+E,$=t.get(R);if($)return $;const g=this.options.loose,w=g?a[l.HYPHENRANGELOOSE]:a[l.HYPHENRANGE];E=E.replace(w,ce(this.options.includePrerelease)),c("hyphen replace",E),E=E.replace(a[l.COMPARATORTRIM],r),c("comparator trim",E),E=E.replace(a[l.TILDETRIM],u),c("tilde trim",E),E=E.replace(a[l.CARETTRIM],f),c("caret trim",E);let O=E.split(" ").map(x=>C(x,this.options)).join(" ").split(/\s+/).map(x=>oe(x,this.options));g&&(O=O.filter(x=>(c("loose invalid filter",x,this.options),!!x.match(a[l.COMPARATORLOOSE])))),c("range list",O);const N=new Map,A=O.map(x=>new o(x,this.options));for(const x of A){if(p(x))return[x];N.set(x.value,x)}N.size>1&&N.has("")&&N.delete("");const D=[...N.values()];return t.set(R,D),D}intersects(E,I){if(!(E instanceof n))throw new TypeError("a Range is required");return this.set.some(R=>T(R,I)&&E.set.some($=>T($,I)&&R.every(g=>$.every(w=>g.intersects(w,I)))))}test(E){if(!E)return!1;if(typeof E=="string")try{E=new h(E,this.options)}catch{return!1}for(let I=0;I<this.set.length;I++)if(ue(this.set[I],E,this.options))return!0;return!1}}je=n;const e=Wt(),t=new e,s=or(),o=se(),c=te(),h=U(),{safeRe:a,t:l,comparatorTrimReplace:r,tildeTrimReplace:u,caretTrimReplace:f}=K(),{FLAG_INCLUDE_PRERELEASE:d,FLAG_LOOSE:v}=re(),p=m=>m.value==="<0.0.0-0",S=m=>m.value==="",T=(m,E)=>{let I=!0;const R=m.slice();let $=R.pop();for(;I&&R.length;)I=R.every(g=>$.intersects(g,E)),$=R.pop();return I},C=(m,E)=>(c("comp",m,E),m=P(m,E),c("caret",m),m=b(m,E),c("tildes",m),m=L(m,E),c("xrange",m),m=ae(m,E),c("stars",m),m),y=m=>!m||m.toLowerCase()==="x"||m==="*",b=(m,E)=>m.trim().split(/\s+/).map(I=>F(I,E)).join(" "),F=(m,E)=>{const I=E.loose?a[l.TILDELOOSE]:a[l.TILDE];return m.replace(I,(R,$,g,w,O)=>{c("tilde",m,R,$,g,w,O);let N;return y($)?N="":y(g)?N=`>=${$}.0.0 <${+$+1}.0.0-0`:y(w)?N=`>=${$}.${g}.0 <${$}.${+g+1}.0-0`:O?(c("replaceTilde pr",O),N=`>=${$}.${g}.${w}-${O} <${$}.${+g+1}.0-0`):N=`>=${$}.${g}.${w} <${$}.${+g+1}.0-0`,c("tilde return",N),N})},P=(m,E)=>m.trim().split(/\s+/).map(I=>q(I,E)).join(" "),q=(m,E)=>{c("caret",m,E);const I=E.loose?a[l.CARETLOOSE]:a[l.CARET],R=E.includePrerelease?"-0":"";return m.replace(I,($,g,w,O,N)=>{c("caret",m,$,g,w,O,N);let A;return y(g)?A="":y(w)?A=`>=${g}.0.0${R} <${+g+1}.0.0-0`:y(O)?g==="0"?A=`>=${g}.${w}.0${R} <${g}.${+w+1}.0-0`:A=`>=${g}.${w}.0${R} <${+g+1}.0.0-0`:N?(c("replaceCaret pr",N),g==="0"?w==="0"?A=`>=${g}.${w}.${O}-${N} <${g}.${w}.${+O+1}-0`:A=`>=${g}.${w}.${O}-${N} <${g}.${+w+1}.0-0`:A=`>=${g}.${w}.${O}-${N} <${+g+1}.0.0-0`):(c("no pr"),g==="0"?w==="0"?A=`>=${g}.${w}.${O}${R} <${g}.${w}.${+O+1}-0`:A=`>=${g}.${w}.${O}${R} <${g}.${+w+1}.0-0`:A=`>=${g}.${w}.${O} <${+g+1}.0.0-0`),c("caret return",A),A})},L=(m,E)=>(c("replaceXRanges",m,E),m.split(/\s+/).map(I=>H(I,E)).join(" ")),H=(m,E)=>{m=m.trim();const I=E.loose?a[l.XRANGELOOSE]:a[l.XRANGE];return m.replace(I,(R,$,g,w,O,N)=>{c("xRange",m,R,$,g,w,O,N);const A=y(g),D=A||y(w),x=D||y(O),z=x;return $==="="&&z&&($=""),N=E.includePrerelease?"-0":"",A?$===">"||$==="<"?R="<0.0.0-0":R="*":$&&z?(D&&(w=0),O=0,$===">"?($=">=",D?(g=+g+1,w=0,O=0):(w=+w+1,O=0)):$==="<="&&($="<",D?g=+g+1:w=+w+1),$==="<"&&(N="-0"),R=`${$+g}.${w}.${O}${N}`):D?R=`>=${g}.0.0${N} <${+g+1}.0.0-0`:x&&(R=`>=${g}.${w}.0${N} <${g}.${+w+1}.0-0`),c("xRange return",R),R})},ae=(m,E)=>(c("replaceStars",m,E),m.trim().replace(a[l.STAR],"")),oe=(m,E)=>(c("replaceGTE0",m,E),m.trim().replace(a[E.includePrerelease?l.GTE0PRE:l.GTE0],"")),ce=m=>(E,I,R,$,g,w,O,N,A,D,x,z)=>(y(R)?I="":y($)?I=`>=${R}.0.0${m?"-0":""}`:y(g)?I=`>=${R}.${$}.0${m?"-0":""}`:w?I=`>=${I}`:I=`>=${I}${m?"-0":""}`,y(A)?N="":y(D)?N=`<${+A+1}.0.0-0`:y(x)?N=`<${A}.${+D+1}.0-0`:z?N=`<=${A}.${D}.${x}-${z}`:m?N=`<${A}.${D}.${+x+1}-0`:N=`<=${N}`,`${I} ${N}`.trim()),ue=(m,E,I)=>{for(let R=0;R<m.length;R++)if(!m[R].test(E))return!1;if(E.prerelease.length&&!I.includePrerelease){for(let R=0;R<m.length;R++)if(c(m[R].semver),m[R].semver!==o.ANY&&m[R].semver.prerelease.length>0){const $=m[R].semver;if($.major===E.major&&$.minor===E.minor&&$.patch===E.patch)return!0}return!1}return!0};return je}var Be,Wr;function se(){if(Wr)return Be;Wr=1;const i=Symbol("SemVer ANY");class n{static get ANY(){return i}constructor(r,u){if(u=e(u),r instanceof n){if(r.loose===!!u.loose)return r;r=r.value}r=r.trim().split(/\s+/).join(" "),c("comparator",r,u),this.options=u,this.loose=!!u.loose,this.parse(r),this.semver===i?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(r){const u=this.options.loose?t[s.COMPARATORLOOSE]:t[s.COMPARATOR],f=r.match(u);if(!f)throw new TypeError(`Invalid comparator: ${r}`);this.operator=f[1]!==void 0?f[1]:"",this.operator==="="&&(this.operator=""),f[2]?this.semver=new h(f[2],this.options.loose):this.semver=i}toString(){return this.value}test(r){if(c("Comparator.test",r,this.options.loose),this.semver===i||r===i)return!0;if(typeof r=="string")try{r=new h(r,this.options)}catch{return!1}return o(r,this.operator,this.semver,this.options)}intersects(r,u){if(!(r instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new a(r.value,u).test(this.value):r.operator===""?r.value===""?!0:new a(this.value,u).test(r.semver):(u=e(u),u.includePrerelease&&(this.value==="<0.0.0-0"||r.value==="<0.0.0-0")||!u.includePrerelease&&(this.value.startsWith("<0.0.0")||r.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&r.operator.startsWith(">")||this.operator.startsWith("<")&&r.operator.startsWith("<")||this.semver.version===r.semver.version&&this.operator.includes("=")&&r.operator.includes("=")||o(this.semver,"<",r.semver,u)&&this.operator.startsWith(">")&&r.operator.startsWith("<")||o(this.semver,">",r.semver,u)&&this.operator.startsWith("<")&&r.operator.startsWith(">")))}}Be=n;const e=or(),{safeRe:t,t:s}=K(),o=It(),c=te(),h=U(),a=j();return Be}var ke,Kr;function ie(){if(Kr)return ke;Kr=1;const i=j();return ke=(e,t,s)=>{try{t=new i(t,s)}catch{return!1}return t.test(e)},ke}var Me,Zr;function Kt(){if(Zr)return Me;Zr=1;const i=j();return Me=(e,t)=>new i(e,t).set.map(s=>s.map(o=>o.value).join(" ").trim().split(" ")),Me}var Xe,Jr;function Zt(){if(Jr)return Xe;Jr=1;const i=U(),n=j();return Xe=(t,s,o)=>{let c=null,h=null,a=null;try{a=new n(s,o)}catch{return null}return t.forEach(l=>{a.test(l)&&(!c||h.compare(l)===-1)&&(c=l,h=new i(c,o))}),c},Xe}var Ve,Qr;function Jt(){if(Qr)return Ve;Qr=1;const i=U(),n=j();return Ve=(t,s,o)=>{let c=null,h=null,a=null;try{a=new n(s,o)}catch{return null}return t.forEach(l=>{a.test(l)&&(!c||h.compare(l)===1)&&(c=l,h=new i(c,o))}),c},Ve}var He,et;function Qt(){if(et)return He;et=1;const i=U(),n=j(),e=ne();return He=(s,o)=>{s=new n(s,o);let c=new i("0.0.0");if(s.test(c)||(c=new i("0.0.0-0"),s.test(c)))return c;c=null;for(let h=0;h<s.set.length;++h){const a=s.set[h];let l=null;a.forEach(r=>{const u=new i(r.semver.version);switch(r.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!l||e(u,l))&&(l=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${r.operator}`)}}),l&&(!c||e(c,l))&&(c=l)}return c&&s.test(c)?c:null},He}var ze,rt;function en(){if(rt)return ze;rt=1;const i=j();return ze=(e,t)=>{try{return new i(e,t).range||"*"}catch{return null}},ze}var Ye,tt;function hr(){if(tt)return Ye;tt=1;const i=U(),n=se(),{ANY:e}=n,t=j(),s=ie(),o=ne(),c=ur(),h=fr(),a=lr();return Ye=(r,u,f,d)=>{r=new i(r,d),u=new t(u,d);let v,p,S,T,C;switch(f){case">":v=o,p=h,S=c,T=">",C=">=";break;case"<":v=c,p=a,S=o,T="<",C="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(r,u,d))return!1;for(let y=0;y<u.set.length;++y){const b=u.set[y];let F=null,P=null;if(b.forEach(q=>{q.semver===e&&(q=new n(">=0.0.0")),F=F||q,P=P||q,v(q.semver,F.semver,d)?F=q:S(q.semver,P.semver,d)&&(P=q)}),F.operator===T||F.operator===C||(!P.operator||P.operator===T)&&p(r,P.semver))return!1;if(P.operator===C&&S(r,P.semver))return!1}return!0},Ye}var We,nt;function rn(){if(nt)return We;nt=1;const i=hr();return We=(e,t,s)=>i(e,t,">",s),We}var Ke,st;function tn(){if(st)return Ke;st=1;const i=hr();return Ke=(e,t,s)=>i(e,t,"<",s),Ke}var Ze,it;function nn(){if(it)return Ze;it=1;const i=j();return Ze=(e,t,s)=>(e=new i(e,s),t=new i(t,s),e.intersects(t,s)),Ze}var Je,at;function sn(){if(at)return Je;at=1;const i=ie(),n=G();return Je=(e,t,s)=>{const o=[];let c=null,h=null;const a=e.sort((f,d)=>n(f,d,s));for(const f of a)i(f,t,s)?(h=f,c||(c=f)):(h&&o.push([c,h]),h=null,c=null);c&&o.push([c,null]);const l=[];for(const[f,d]of o)f===d?l.push(f):!d&&f===a[0]?l.push("*"):d?f===a[0]?l.push(`<=${d}`):l.push(`${f} - ${d}`):l.push(`>=${f}`);const r=l.join(" || "),u=typeof t.raw=="string"?t.raw:String(t);return r.length<u.length?r:t},Je}var Qe,ot;function an(){if(ot)return Qe;ot=1;const i=j(),n=se(),{ANY:e}=n,t=ie(),s=G(),o=(u,f,d={})=>{if(u===f)return!0;u=new i(u,d),f=new i(f,d);let v=!1;e:for(const p of u.set){for(const S of f.set){const T=a(p,S,d);if(v=v||T!==null,T)continue e}if(v)return!1}return!0},c=[new n(">=0.0.0-0")],h=[new n(">=0.0.0")],a=(u,f,d)=>{if(u===f)return!0;if(u.length===1&&u[0].semver===e){if(f.length===1&&f[0].semver===e)return!0;d.includePrerelease?u=c:u=h}if(f.length===1&&f[0].semver===e){if(d.includePrerelease)return!0;f=h}const v=new Set;let p,S;for(const L of u)L.operator===">"||L.operator===">="?p=l(p,L,d):L.operator==="<"||L.operator==="<="?S=r(S,L,d):v.add(L.semver);if(v.size>1)return null;let T;if(p&&S){if(T=s(p.semver,S.semver,d),T>0)return null;if(T===0&&(p.operator!==">="||S.operator!=="<="))return null}for(const L of v){if(p&&!t(L,String(p),d)||S&&!t(L,String(S),d))return null;for(const H of f)if(!t(L,String(H),d))return!1;return!0}let C,y,b,F,P=S&&!d.includePrerelease&&S.semver.prerelease.length?S.semver:!1,q=p&&!d.includePrerelease&&p.semver.prerelease.length?p.semver:!1;P&&P.prerelease.length===1&&S.operator==="<"&&P.prerelease[0]===0&&(P=!1);for(const L of f){if(F=F||L.operator===">"||L.operator===">=",b=b||L.operator==="<"||L.operator==="<=",p){if(q&&L.semver.prerelease&&L.semver.prerelease.length&&L.semver.major===q.major&&L.semver.minor===q.minor&&L.semver.patch===q.patch&&(q=!1),L.operator===">"||L.operator===">="){if(C=l(p,L,d),C===L&&C!==p)return!1}else if(p.operator===">="&&!t(p.semver,String(L),d))return!1}if(S){if(P&&L.semver.prerelease&&L.semver.prerelease.length&&L.semver.major===P.major&&L.semver.minor===P.minor&&L.semver.patch===P.patch&&(P=!1),L.operator==="<"||L.operator==="<="){if(y=r(S,L,d),y===L&&y!==S)return!1}else if(S.operator==="<="&&!t(S.semver,String(L),d))return!1}if(!L.operator&&(S||p)&&T!==0)return!1}return!(p&&b&&!S&&T!==0||S&&F&&!p&&T!==0||q||P)},l=(u,f,d)=>{if(!u)return f;const v=s(u.semver,f.semver,d);return v>0?u:v<0||f.operator===">"&&u.operator===">="?f:u},r=(u,f,d)=>{if(!u)return f;const v=s(u.semver,f.semver,d);return v<0?u:v>0||f.operator==="<"&&u.operator==="<="?f:u};return Qe=o,Qe}var er,ct;function on(){if(ct)return er;ct=1;const i=K(),n=re(),e=U(),t=vt(),s=V(),o=Dt(),c=Ut(),h=Ft(),a=Gt(),l=jt(),r=Bt(),u=kt(),f=Mt(),d=G(),v=Xt(),p=Vt(),S=cr(),T=Ht(),C=zt(),y=ne(),b=ur(),F=Rt(),P=gt(),q=lr(),L=fr(),H=It(),ae=Yt(),oe=se(),ce=j(),ue=ie(),m=Kt(),E=Zt(),I=Jt(),R=Qt(),$=en(),g=hr(),w=rn(),O=tn(),N=nn(),A=sn(),D=an();return er={parse:s,valid:o,clean:c,inc:h,diff:a,major:l,minor:r,patch:u,prerelease:f,compare:d,rcompare:v,compareLoose:p,compareBuild:S,sort:T,rsort:C,gt:y,lt:b,eq:F,neq:P,gte:q,lte:L,cmp:H,coerce:ae,Comparator:oe,Range:ce,satisfies:ue,toComparators:m,maxSatisfying:E,minSatisfying:I,minVersion:R,validRange:$,outside:g,gtr:w,ltr:O,intersects:N,simplifyRange:A,subset:D,SemVer:e,re:i.re,src:i.src,tokens:i.t,SEMVER_SPEC_VERSION:n.SEMVER_SPEC_VERSION,RELEASE_TYPES:n.RELEASE_TYPES,compareIdentifiers:t.compareIdentifiers,rcompareIdentifiers:t.rcompareIdentifiers},er}var cn=on();const ut=pt(cn);var nr=function(){return nr=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])}return i},nr.apply(this,arguments)},X,_;(function(i){i.blue="blue",i.nanoS="nanoS",i.nanoSP="nanoSP",i.nanoX="nanoX",i.nanoFTS="nanoFTS"})(_||(_={}));var sr=(X={},X[_.blue]={id:_.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:function(i){return 4*1024}},X[_.nanoS]={id:_.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:function(i){var n;return ut.lt((n=ut.coerce(i))!==null&&n!==void 0?n:"","2.0.0")?4*1024:2*1024}},X[_.nanoSP]={id:_.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1536*1024,masks:[856686592],getBlockSize:function(i){return 32}},X[_.nanoX]={id:_.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:function(i){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},X[_.nanoFTS]={id:_.nanoFTS,productName:"Ledger Nano FTS",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:2*1024*1024,masks:[857735168],getBlockSize:function(i){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},X);_.blue,_.nanoS,_.nanoSP,_.nanoX,_.nanoFTS;var lt=Object.values(sr),$t=11415,ft=function(i){var n=lt.find(function(s){return s.legacyUsbProductId===i});if(n)return n;var e=i>>8,t=lt.find(function(s){return s.productIdMM===e});return t},un=[],ht={};for(var ln in sr){var dt=sr[ln],rr=dt.bluetoothSpec;if(rr)for(var tr=0;tr<rr.length;tr++){var Q=rr[tr];un.push(Q.serviceUuid),ht[Q.serviceUuid]=ht[Q.serviceUuid.replace(/-/g,"")]=nr({deviceModel:dt},Q)}}var fn=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),B=function(i,n,e,t){function s(o){return o instanceof e?o:new e(function(c){c(o)})}return new(e||(e=Promise))(function(o,c){function h(r){try{l(t.next(r))}catch(u){c(u)}}function a(r){try{l(t.throw(r))}catch(u){c(u)}}function l(r){r.done?o(r.value):s(r.value).then(h,a)}l((t=t.apply(i,n||[])).next())})},k=function(i,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},t,s,o,c;return c={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function h(l){return function(r){return a([l,r])}}function a(l){if(t)throw new TypeError("Generator is already executing.");for(;e;)try{if(t=1,s&&(o=l[0]&2?s.return:l[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,l[1])).done)return o;switch(s=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,s=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){e.label=l[1];break}if(l[0]===6&&e.label<o[1]){e.label=o[1],o=l;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(l);break}o[2]&&e.ops.pop(),e.trys.pop();continue}l=n.call(i,e)}catch(r){l=[6,r],s=0}finally{t=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},hn=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),s,o=[],c;try{for(;(n===void 0||n-- >0)&&!(s=t.next()).done;)o.push(s.value)}catch(h){c={error:h}}finally{try{s&&!s.done&&(e=t.return)&&e.call(t)}finally{if(c)throw c.error}}return o},dn=[{vendorId:$t}],pn=function(){return Promise.resolve(!!(window.navigator&&window.navigator.hid))},ee=function(){var i=navigator.hid;if(!i)throw new Y("navigator.hid is not supported","HIDNotSupported");return i};function St(){return B(this,void 0,void 0,function(){var i;return k(this,function(n){switch(n.label){case 0:return[4,ee().requestDevice({filters:dn})];case 1:return i=n.sent(),Array.isArray(i)?[2,i]:[2,[i]]}})})}function ir(){return B(this,void 0,void 0,function(){var i;return k(this,function(n){switch(n.label){case 0:return[4,ee().getDevices()];case 1:return i=n.sent(),[2,i.filter(function(e){return e.vendorId===$t})]}})})}function En(){return B(this,void 0,void 0,function(){var i,n;return k(this,function(e){switch(e.label){case 0:return[4,ir()];case 1:return i=e.sent(),i.length>0?[2,i[0]]:[4,St()];case 2:return n=e.sent(),[2,n[0]]}})})}var vn=function(i){fn(n,i);function n(e){var t=i.call(this)||this;return t.channel=Math.floor(Math.random()*65535),t.packetSize=64,t.inputs=[],t.read=function(){return t.inputs.length?Promise.resolve(t.inputs.shift()):new Promise(function(s){t.inputCallback=s})},t.onInputReport=function(s){var o=Buffer.from(s.data.buffer);t.inputCallback?(t.inputCallback(o),t.inputCallback=null):t.inputs.push(o)},t._disconnectEmitted=!1,t._emitDisconnect=function(s){t._disconnectEmitted||(t._disconnectEmitted=!0,t.emit("disconnect",s))},t.exchange=function(s){return B(t,void 0,void 0,function(){var o,c=this;return k(this,function(h){switch(h.label){case 0:return[4,this.exchangeAtomicImpl(function(){return B(c,void 0,void 0,function(){var a,l,r,u,f,d,v,p,S;return k(this,function(T){switch(T.label){case 0:a=this,l=a.channel,r=a.packetSize,mr("apdu","=> "+s.toString("hex")),u=bt(l,r),f=u.makeBlocks(s),d=0,T.label=1;case 1:return d<f.length?[4,this.device.sendReport(0,f[d])]:[3,4];case 2:T.sent(),T.label=3;case 3:return d++,[3,1];case 4:return(v=u.getReducedResult(p))?[3,6]:[4,this.read()];case 5:return S=T.sent(),p=u.reduceResponse(p,S),[3,4];case 6:return mr("apdu","<= "+v.toString("hex")),[2,v]}})})}).catch(function(a){throw a&&a.message&&a.message.includes("write")?(c._emitDisconnect(a),new Ot(a.message)):a})];case 1:return o=h.sent(),[2,o]}})})},t.device=e,t.deviceModel=typeof e.productId=="number"?ft(e.productId):void 0,e.addEventListener("inputreport",t.onInputReport),t}return n.request=function(){return B(this,void 0,void 0,function(){var e,t;return k(this,function(s){switch(s.label){case 0:return[4,St()];case 1:return e=hn.apply(void 0,[s.sent(),1]),t=e[0],[2,n.open(t)]}})})},n.openConnected=function(){return B(this,void 0,void 0,function(){var e;return k(this,function(t){switch(t.label){case 0:return[4,ir()];case 1:return e=t.sent(),e.length===0?[2,null]:[2,n.open(e[0])]}})})},n.open=function(e){return B(this,void 0,void 0,function(){var t,s;return k(this,function(o){switch(o.label){case 0:return[4,e.open()];case 1:return o.sent(),t=new n(e),s=function(c){e===c.device&&(ee().removeEventListener("disconnect",s),t._emitDisconnect(new yt))},ee().addEventListener("disconnect",s),[2,t]}})})},n.prototype.close=function(){return B(this,void 0,void 0,function(){return k(this,function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),this.device.removeEventListener("inputreport",this.onInputReport),[4,this.device.close()];case 2:return e.sent(),[2]}})})},n.prototype.setScrambleKey=function(){},n.isSupported=pn,n.list=ir,n.listen=function(e){var t=!1;En().then(function(o){if(!o)e.error(new Er("Access denied to use Ledger device"));else if(!t){var c=typeof o.productId=="number"?ft(o.productId):void 0;e.next({type:"add",descriptor:o,deviceModel:c}),e.complete()}},function(o){e.error(new Er(o.message))});function s(){t=!0}return{unsubscribe:s}},n}(ar);export{vn as default};
